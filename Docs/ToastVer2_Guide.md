# ToastVer2 - Excel VBA用高度なトースト通知システム

## 概要

ToastVer2は、Excelでの作業中にユーザーに情報を伝えるための非侵襲的な通知システムです。従来のMsgBoxとは異なり、ユーザーの作業を中断することなく、重要な情報を表示することができます。

主な特徴:
- 複数の通知種類（情報/成功/警告/エラー）
- カスタマイズ可能な表示時間
- スムーズなアニメーションエフェクト
- 複数の通知をキュー管理
- クリックまたはキー入力で閉じる機能

## インストール方法

1. VBAプロジェクトに以下のファイルをインポートします:
   - `Class/ToastManagerVer2.cls`
   - `Form/ToastVer2.frm` (および対応する`.frx`ファイル)
   - `Module/M_ToastVer2.bas`
   - (オプション) `Module/M_ToastVer2_Test.bas`

2. VBAプロジェクトが参照設定で「Microsoft Forms 2.0 Object Library」を参照していることを確認します。

## 基本的な使用方法

ToastVer2は以下のようにシンプルに使用できます:

```vba
' 基本的な情報トースト
ShowToastVer2 "処理が完了しました", "info", 2000

' またはより直感的に
ShowInfoToast "処理が完了しました"
ShowSuccessToast "保存しました"
ShowWarningToast "注意が必要です"
ShowErrorToast "エラーが発生しました"
```

## 関数リファレンス

### 主要関数

| 関数 | 説明 | パラメータ |
|------|------|------------|
| `ShowToastVer2` | 基本的なトースト通知を表示 | Message(必須), ToastType(省略可), Duration(省略可), IconType(省略可) |
| `ShowInfoToast` | 情報トースト（青色）を表示 | Message(必須), Duration(省略可) |
| `ShowSuccessToast` | 成功トースト（緑色）を表示 | Message(必須), Duration(省略可) |
| `ShowWarningToast` | 警告トースト（オレンジ色）を表示 | Message(必須), Duration(省略可) |
| `ShowErrorToast` | エラートースト（赤色）を表示 | Message(必須), Duration(省略可) |

### 補助関数

| 関数 | 説明 |
|------|------|
| `GetToastQueueSize` | 現在のキュー内のトースト数を取得 |
| `IsProcessingToasts` | 現在トーストを処理中かどうかを取得 |
| `ClearToastQueue` | トーストキューをクリア |

## パラメータ詳細

| パラメータ | 説明 | 有効な値 | デフォルト値 |
|----------|------|---------|------------|
| `Message` | 表示するメッセージテキスト | 任意の文字列 | (必須) |
| `ToastType` | トースト通知の種類 | "info", "success", "warning", "error" | "info" |
| `Duration` | 表示時間（ミリ秒） | 正の整数 | 2000 (2秒) |
| `IconType` | 表示するアイコンの種類 | "info", "success", "warning", "error" | ToastTypeと同じ |

## 使用例

### 基本的な使用例

```vba
' 保存成功の通知
ShowSuccessToast "ファイルが保存されました"

' 3秒間表示するエラー通知
ShowErrorToast "接続エラーが発生しました", 3000
```

### 実際のシナリオ例

```vba
' 処理開始の通知
ShowInfoToast "データのエクスポートを開始します..."

' 実際の処理を実行
ExportData

' 処理完了の通知
ShowSuccessToast "データのエクスポートが完了しました", 3000
```

### 複数通知の連続表示

```vba
' 複数の通知を連続して表示（自動的にキュー管理されます）
ShowInfoToast "処理を開始します"
ShowInfoToast "データを読み込んでいます..."
ShowInfoToast "計算中..."
ShowSuccessToast "処理が完了しました"
```

## カスタマイズ

ToastVer2は内部的にカスタマイズが可能です。より高度なカスタマイズが必要な場合は、以下のファイルを編集してください:

1. `ToastVer2.frm` - フォームのデザインとアニメーション
2. `ToastManagerVer2.cls` - トースト通知の管理とキュー処理
3. `M_ToastVer2.bas` - イージング関数やユーティリティ関数

## トラブルシューティング

### 一般的な問題と解決策

| 問題 | 考えられる原因 | 解決策 |
|------|--------------|-------|
| トーストが表示されない | フォームリファレンスのエラー | フォームとクラスが正しくインポートされているか確認 |
| アニメーションが遅い | PCのパフォーマンス | `ANIM_STEP_DELAY`の値を下げる |
| キューが動作しない | イベントの無効化 | `Application.EnableEvents`が`True`になっているか確認 |

### デバッグ方法

デバッグが必要な場合は、`M_ToastVer2_Test.bas`モジュールに含まれるテスト関数を使用して、個々の機能をテストできます。特に`RunAllTests`関数は、すべての機能を一度にテストするのに便利です。

## 既存のToast機能との互換性

ToastVer2は、既存のToast機能と並行して使用できるように設計されています。既存の`ShowToast`関数と`ToastVer2`の関数は互いに干渉しません。

## パフォーマンスに関する注意

- トースト通知はわずかなオーバーヘッドを生じさせる可能性があります。
- 非常に頻繁に通知を表示すると、パフォーマンスに影響する可能性があります。
- `DoEvents`の使用により、マクロの実行中にユーザー操作を受け付けることができますが、これにより処理時間が若干増加する可能性があります。

## 開発者向け情報

ToastVer2は、拡張性を考慮して設計されています。新しい機能を追加する場合は、以下のガイドラインに従ってください:

1. トースト通知のデザインを変更する場合は、`ToastVer2.frm`を編集します。
2. 新しいトースト種類を追加する場合は、`ToastManagerVer2.cls`の`ValidateToastType`関数を更新します。
3. 新しいアニメーション効果を追加する場合は、`M_ToastVer2.bas`にイージング関数を追加します。

---

## 更新履歴

| バージョン | 日付 | 変更内容 |
|----------|------|---------|
| 2.0.0 | 2025/04/25 | 初回リリース |

## ライセンス

このコードは自由に使用、修正、配布することができます。

---

*このドキュメントは2025年4月25日に作成されました。*
